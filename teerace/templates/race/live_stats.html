{% extends "base.html" %}{% load race_tags %}
{% comment %}
context variables:
	servers_online
	players_online
{% endcomment %}
{% block title %}live stats - {{ block.super }}{% endblock title %}
{% block breadcrumb %}
	{{ block.super }}
	{% load breadcrumb_tags %}
	{% add_crumb "Live stats" 'live_stats' %}
{% endblock %}
{% block content %}
	<div class="box full">
		{% if servers_online %}
		<div class="header">Live stats</div>
		{% endif %}
		{% for server in servers_online %}
			<div class="live">
				<h3>{{ server.name }}</h3>
				<div class="address">{{ server.address }}{% if server.played_map %}{% if server.address %}, {% endif %}<a href="{{ server.played_map.get_absolute_url }}">{{ server.played_map.name }}</a> map{% endif %}</div>
				<div class="description">{{ server.description }}</div>
				<ul>
				{% for player in server.players.all %}
					{% if player.is_online %}
						<li><span class="name">{{ player.user.username }}</span>{% if server.played_map %}<span class="time">{{ player|map_time:server.played_map }}</span><span class="points">{{ player|map_points:server.played_map }}</span>{% endif %}</li>
					{% endif %}
				{% endfor %}
				{% for anonymous in server.anonymous_players %}
					<li><span class="name">{{ anonymous }}</span></li>
				{% endfor %}
				</ul>
			</div>
		{% endfor %}
		<div class="header"></div>
		<div class="live-stats">
			<span>{{ servers_online|length }}</span> server{{ servers_online|length|pluralize }} online
		</div>
		<div class="live-stats">
			<span>{{ players_online|length }}</span> player{{ players_online|length|pluralize }} online
		</div>
	</div>
{% endblock content %}
